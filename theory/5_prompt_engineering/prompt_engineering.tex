\section{Prompt Engineering}
\label{sec:pe}
%
\begin{frame}[t] \frametitle{\emph{Prompt Engineering}}
\framesubtitle{Definizione}
{\small
\onslide<1->
    \begin{minipage}[t]{\textwidth}
        \vspace*{-.5cm}
        \begin{figure}
            \centering
            \includegraphics[width=.25\textwidth]{img/PE-1.PNG}
            \includegraphics[width=.25\textwidth]{img/PE-2.PNG}
            \includegraphics[width=.25\textwidth]{img/PE-3.PNG}
        \end{figure}
    \end{minipage}
    \\\vspace*{.3cm}
    \begin{minipage}[t]{\textwidth}
        \begin{itemize}[leftmargin=10pt,align=right]
            \onslide<1->\item[\alert{\faArrowCircleRight}] Definiamo meglio il concetto di \emph{prompt}$\ldots$
        \end{itemize}
    \end{minipage}
}
\end{frame}
%
\begin{frame}[t] \frametitle{\emph{Prompt Engineering}}
\framesubtitle{Componenti principali}
{\small
\onslide<1->
    \begin{minipage}[t]{\textwidth}
        \begin{itemize}[leftmargin=70pt,align=right]
            \onslide<1->\item[\alert{Istruzione}] indicazioni/suggerimenti specifici che si presentano al modello per raggiungere l'azione desiderata (designano la \emph{task} da compiere)
            \onslide<2->\item[\alert{Contesto}] informazioni aggiuntive che possono indirizzare e addestrare il modello in modo che generi risposte migliori, pertinenti e coerenti con l’obiettivo
            \onslide<3->\item[\alert{Dati di \emph{input}}] il testo contenente ciò a cui si è interessati a trovare una risposta
            \onslide<4->\item[\alert{Indicatore di \emph{output}}] la tipologia o il formato che si vuole ottenere nella risposta
        \end{itemize}
        \vspace*{.5cm}
        \begin{itemize}[leftmargin=10pt,align=right]
            \onslide<5->\item[\alert{\faArrowCircleRight}] Dati di \emph{input} obbligatori
            \onslide<6->\item[\alert{\faArrowCircleRight}] Altri dati opzionali
        \end{itemize}
    \end{minipage}
}
\end{frame}
%
\begin{frame}[t] \frametitle{\emph{Prompt Engineering}}
\framesubtitle{Il perfetto prompt engineer}
	{\footnotesize
	    \begin{minipage}[t]{\textwidth}
			\begin{minipage}[t]{0.6\textwidth}
	    		\begin{itemize}[leftmargin=10pt,align=right]
					\onslide<1->\item[\alert{\faArrowCircleRight}] Sceglie uno \alert{specifico} modello da ottimizzare
					\onslide<2->\item[\alert{\faArrowCircleRight}] Capisce come è stato addestrato il modello
					\onslide<3->\item[\alert{\faArrowCircleRight}] Capisce come è stato configurato il modello
                    \onslide<4->\item[\alert{\faArrowCircleRight}] Comprende come riconfigurare il modello
					\onslide<5->\item[\alert{\faArrowCircleRight}] Si esprime efficacemente con il modello
                    \begin{itemize}[leftmargin=10pt,align=right]
                        \item[\alert{\faArrowCircleRight}] Stile
                        \item[\alert{\faArrowCircleRight}] Tono
                        \item[\alert{\faArrowCircleRight}] Struttura
                        \item[\alert{\faArrowCircleRight}] Scelta delle parole
                    \end{itemize}
                    \onslide<6->\item[\alert{\faArrowCircleRight}] Dedica il suo lavoro a tutto questo
                    \onslide<7->\item[\alert{\faExclamationTriangle}] Spinge il LLM verso un comportamento \alert{pseudo-deterministico}  
				\end{itemize}
            \end{minipage}
            %
			\hfill
            \onslide<1->
            \begin{minipage}[t]{0.4\textwidth}
                \centering
                \begin{figure}[ht]
                    \includegraphics[width=\textwidth]{the-mentalist.jpg}
                    {\tiny\\The mentalist\\\vspace*{-1pt}\textit{\textcopyright Prime Video}}
                \end{figure}
            \end{minipage}
	    \end{minipage}
	}
\end{frame}
%
\begin{frame}[t] \frametitle{\emph{Prompt Engineering}}
\framesubtitle{Controlli di output LLM}
{\small
    \begin{minipage}[t]{\textwidth}
        \begin{itemize}[leftmargin=10pt,align=right]
            \onslide<1->\item[\alertedcircled{1}] \alert{Lunghezza massima:} numero di \emph{token} massimo generato dal modello
            \begin{itemize}[leftmargin=10pt,align=right]
                \onslide<2->\item[\alert{\faArrowCircleRight}] Evitare alti consumi (energetici, economici, \ldots)
                \onslide<3->\item[\alert{\faArrowCircleRight}] Abbattere i tempi di risposta
                \onslide<4->\item[\alert{\faArrowCircleRight}] Cruciale in alcuni tipi di strategie di \textit{prompting} (ReAct) e per alcune tipologie di \textit{task}
                \onslide<5->\item[\alert{\faExclamationTriangle}] \alert{Non} impone modifiche stilistiche al modello!
            \end{itemize}
        \end{itemize}
    \end{minipage}
}
\end{frame}
%
\begin{frame}[t] \frametitle{\emph{Prompt Engineering}}
\framesubtitle{Controlli di output LLM}
{\footnotesize
    \begin{minipage}[t]{\textwidth}
        \begin{itemize}[leftmargin=10pt,align=right]
            \onslide<1->\item[\alertedcircled{2}] \alert{Creatività del modello:} libertà nella scelta del \emph{token} successivo
            \begin{itemize}[leftmargin=10pt,align=right]
                \onslide<2->\item[\alert{\faArrowCircleRight}] \alert{Temperatura:}
                \begin{itemize}[leftmargin=10pt,align=right]
                    \item[\alert{\faArrowCircleRight}] \alert{Bassa} se vogliamo risposte più deterministiche
                    \item[\alert{\faArrowCircleRight}] \alert{Alta} per risposte ``creative''
                    \item[\alert{\faExclamationTriangle}] Intervallo $[0, +\infty]$
                \end{itemize}
                \onslide<3->\item[\alert{\faArrowCircleRight}] \alert{Top-K:} seleziona i primi K \textit{token} più probabili dalla distribuzione
                 \begin{itemize}[leftmargin=10pt,align=right]
                    \item[\alert{\faExclamationTriangle}] Intervallo $[0, +\infty]$
                \end{itemize}               
                \onslide<4->\item[\alert{\faArrowCircleRight}] \alert{Top-P:} seleziona i \textit{token} più probabili e la cui probabilità cumulativa non supera P
                  \begin{itemize}[leftmargin=10pt,align=right]
                    \item[\alert{\faExclamationTriangle}] Intervallo $[0, 1]$
                \end{itemize}                    
                \onslide<5->\item[\alert{\faExclamationTriangle}] Non sempre tutti disponibili!
            \end{itemize}
        \end{itemize}
    \end{minipage}
}
\end{frame}
%
\begin{frame}[t] \frametitle{\emph{Prompt Engineering}}
\framesubtitle{Come bilanciare temperatura, Top-P, Top-K?}
	{\small
	    \begin{minipage}[t]{\textwidth}
			\begin{minipage}[t]{0.55\textwidth}
	    		\begin{itemize}[leftmargin=10pt,align=right]
					\onslide<1->\item[\alert{\faArrowCircleRight}] Attenzione alle configurazioni estreme
                    {\scriptsize
                        \begin{table}
                        %% increase table row spacing, adjust to taste
                        \renewcommand{\arraystretch}{1}
                        \centering
                        \begin{tabularx}{\textwidth}{p{.2\textwidth}p{.7\textwidth}}
                            \toprule
                            \textbf{\emph{Setup}} & \textbf{Effetto}\\
                            \midrule
                            Temp $=0$ & Top-P, Top-K irrilevanti (\alert{\textit{greedy decoding}})\\
                            Temp $\gg 0$ & Temp irrilevante\\
                            \midrule
                            Top-K $=1$ & Temp, Top-P irrilevanti\\
                            Top-K $\gg 1$ & Temp, Top-P irrilevanti (\alert{\textit{greedy decoding}})\\
                            \midrule
                            Top-P $=0$ & Temp, Top-K irrilevanti\\
                            Top-P $=1$ & Top-P irrilevante\\
                            \bottomrule
                        \end{tabularx}
                        \end{table}
                    }
                \end{itemize}
            \end{minipage}
            %
			\hfill
            \onslide<1->
            \begin{minipage}[t]{0.38\textwidth}
                \centering
                \begin{figure}[ht]
                    \includegraphics[width=.9\textwidth]{yzma-cronk.jpg}
                    {\tiny\\Yzma e Kronk\\\vspace*{-1pt}\textit{\textcopyright Disney}}
                \end{figure}
            \end{minipage}
	    \end{minipage}
	}
\end{frame}
%
\begin{frame}[t] \frametitle{\emph{Prompt Engineering}}
\framesubtitle{Controlli di output LLM}
{\footnotesize
    \begin{minipage}[t]{\textwidth}
        \begin{itemize}[leftmargin=80pt,align=right]
            \onslide<1->\item[\alert{Creatività del modello}] quanta libertà lasciamo al LLM nella scelta del \emph{token} successivo
            \begin{itemize}[leftmargin=50pt,align=right]
            \onslide<2->\item[\alert{Temperatura}] più è bassa, più deterministica la generazione dei \emph{token} successivi (ovvero, preso sempre il \emph{token} più probabile)
            \onslide<3->\item[\alert{\emph{Top P}}] definisce una finestra di probabilità entro la quale poter scegliere il \emph{token} successivo (da abbassare quando si vogliono risposte fattuali, da alzare se si vuole un testo più ``fuori dagli schemi'')
            \onslide<4->\item[\alert{\faExclamationTriangle}] Non modificare entrambe!!!
            \end{itemize}
            \onslide<5->\item[\alert{Lunghezza massima}] numero di \emph{token} massimo generato dal modello
            \onslide<6->\item[\alert{\emph{Stop sequences}}] lista di \emph{token} che dice al modello di terminare la generazione
            \onslide<7->\item[\alert{\emph{Token penalties}}] contro la ripetizione dei medesimi \emph{token}
            \begin{itemize}[leftmargin=63pt,align=right]
                \onslide<8->\item[\alert{\emph{Frequence penalty}}] proporzionalmente al n° di volte usato nella sequenza
                \onslide<9->\item[\alert{\emph{Presence penalty}}] globale per tutti i \emph{token} ripetuti
                \onslide<10->\item[\alert{\faExclamationTriangle}] Non modificare entrambe!!!
            \end{itemize}
        \end{itemize}
    \end{minipage}
}
\end{frame}
%
\begin{frame}[t] \frametitle{\emph{Prompt Engineering}}
\framesubtitle{Tipologie di \emph{prompting}}
{\footnotesize
    \begin{minipage}[t]{\textwidth}
        \begin{itemize}[leftmargin=50pt,align=right]
            \onslide<1->\item[\alert{\emph{Direct}}] solo dati di \emph{input}, senza nemmeno definire la \emph{task} obiettivo
            \begin{itemize}[leftmargin=15pt,align=right]
                \item[\alert{\faArrowCircleRight}] Utilizzare il modello secondo la sua natura specifica, senza specializzarlo
            \end{itemize}
            \onslide<2->\item[\alert{\emph{0-Shot}}] \emph{task} specificata, ma la richiesta dell'utente è priva di informazioni sul contesto o priva di esempi
            \onslide<3->\item[\alert{\emph{Few-shots}}] la richiesta dell'utente è seguita da alcuni esempi su cui la LLM tara il \emph{template} delle risposte da fornire
            \onslide<4->\item[\alert{\emph{Role-based}}] le informazioni del \emph{prompt} sono suddivise tra una entità \emph{superuser} (\emph{system} o \emph{admin}) e una entità \emph{user}
            \begin{itemize}[leftmargin=15pt,align=right]
                \onslide<5->\item[\alert{\faArrowCircleRight}] Contesto, definizione \emph{task} e formattazione \emph{output} al \emph{system}
                \onslide<6->\item[\alert{\faArrowCircleRight}] \emph{Input} allo \emph{user}
            \end{itemize}
            \onslide<7->\item[\alert{\emph{Chain-of-Thought}}] il \emph{prompt} viene costruito affinché il LLM possa ``ragionare'' per passi sequenziali, sfruttando man mano i dati che ha generato
            \begin{itemize}[leftmargin=15pt,align=right]
                \onslide<8->\item[\alert{\faArrowCircleRight}] Utilizzato per le \emph{task} di risoluzione problemi di logica, matematica e simili
            \end{itemize}
        \end{itemize}
    \end{minipage}
}
\end{frame}
%